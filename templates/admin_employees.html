<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>员工信息总览</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
  <div class="bg-white shadow-lg rounded-lg p-8 w-full max-w-7xl">
    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">员工信息总览</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4">
          {% for category, message in messages %}
            <div class="text-center text-sm p-2 rounded 
                        {% if category == 'success' %}bg-green-100 text-green-800
                        {% elif category == 'error' %}bg-red-100 text-red-800
                        {% else %}bg-gray-100 text-gray-800{% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% if employees %}
      <div class="overflow-x-auto">
        <table class="table-auto w-full border border-gray-300 text-sm">
          <thead class="bg-gray-100 text-gray-700 font-semibold">
            <tr>
              <th class="px-4 py-2 border">工号</th>
              <th class="px-4 py-2 border">姓名</th>
              <th class="px-4 py-2 border">性别</th>
              <th class="px-4 py-2 border">学历</th>
              <th class="px-4 py-2 border">部门</th>
              <th class="px-4 py-2 border">岗位</th>
              <th class="px-4 py-2 border">薪资</th>
              <th class="px-4 py-2 border">电话</th>
              <th class="px-4 py-2 border">邮箱</th>
              <th class="px-4 py-2 border">操作</th>
            </tr>
          </thead>
          <tbody>
            {% for row in employees %}
              <tr class="text-center hover:bg-gray-50">
                <td class="px-4 py-2 border">{{ row.emp_id }}</td>
                <td class="px-4 py-2 border">{{ row.name }}</td>
                <td class="px-4 py-2 border">{{ row.gender }}</td>
                <td class="px-4 py-2 border">{{ row.education }}</td>
                <td class="px-4 py-2 border">{{ row.dept_name }}</td>
                <td class="px-4 py-2 border">{{ row.pos_name }}</td>
                <td class="px-4 py-2 border text-green-600 font-semibold">¥{{ row.salary }}</td>
                <td class="px-4 py-2 border">{{ row.phone }}</td>
                <td class="px-4 py-2 border">{{ row.email }}</td>
                <td class="px-4 py-2 border">
                  <form method="post" action="{{ url_for('delete_employee', emp_id=row.emp_id) }}" onsubmit="return confirm('确定要删除该员工及其相关信息吗？');">
                    <button type="submit" class="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded">
                      删除
                    </button>
                  </form>
                  <a href="{{ url_for('view_attendance', emp_id=row.emp_id) }}" class="inline-block bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded">
                    查看考勤
                  </a>
                  <a href="{{ url_for('view_leave_records', emp_id=row.emp_id) }}" class="inline-block bg-yellow-500 hover:bg-yellow-600 text-white py-1 px-3 rounded mt-1">
                    查看请假
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-gray-500 text-center">暂无员工数据</p>
    {% endif %}

    <div class="mt-6 text-center">
      <a href="{{ url_for('dashboard') }}" class="bg-gray-500 text-white py-2 px-6 rounded hover:bg-gray-600">返回</a>
    </div>
  </div>
</body>
</html>
